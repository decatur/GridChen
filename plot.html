<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Charting Demo</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- Hack to make it work offline -->
    <script src="examples/plotly_1.48.3.js"></script>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
            background-color: aliceblue;
        }
    </style>
</head>
<body>

<h1><a href="index.html">GridChen Index</a> / Charting Demo</h1>

<p>
    Alt+F1 opens a modal chart of the selection. Try to select
    first and second column then Alt+F1, or all columns then Alt+F1, or second and third column then Alt+F1.
    This demo uses Plotly.js and a small <a href="examples/plotly_wrapper.js">plotly wrapper</a>.
</p>

<grid-chen style="display:block; height: 400px"></grid-chen>

<script type="module">
    import "./modules/GridChen/GridChen.js"
    import {createView} from "./modules/GridChen/DataViews.js"
    import {renderPlot} from "./examples/plotly_wrapper.js"

    const schema = {
        title: 'Charting Demo',
        type: 'object',
        properties: {
            time: {
                title: 'Time t',
                type: 'object',
                items: {
                    type: 'Date', format: 'date-time', width: '200'
                }
            },
            sin: {
                title: 'sin(t/7)',
                type: 'object',
                items: {
                    type: 'number', width: '70'
                }
            },
            cos: {
                title: 'cos(t/5)',
                type: 'object',
                items: {
                    type: 'number', width: '70'
                }
            }
        }
    };

    const data = {
        time: [], sin: [], cos: []
    };

    const now = new Date().getTime();
    const millisInHour = 3600 * 1000;
    for (let i = 0; i < 1000; i++) {
        data.time.push(new Date(now + i * 3600 * 1000));
        data.sin.push(Math.sin(i / 7));
        data.cos.push(Math.cos(i / 5));
    }

    document.querySelector('grid-chen')
        .resetFromView(createView(schema, data))
        .setEventListener('plot',
            (container, title, schemas, series) => renderPlot(container, title, schemas, series))


</script>
</body>
</html>
